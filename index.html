<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perpetual Solutions | Action Tracking Tools</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');
        
        :root {
            /* Palette derived from the uploaded logo image */
            --ps-teal: #00b8b8; 
            --ps-teal-dark: #008f8f;
            --ps-grey: #e2e8f0;
            --ps-slate: #0f172a;
            --ps-red: #dc2626; 
        }

        body { 
            font-family: 'Plus Jakarta Sans', sans-serif; 
            background-color: #f8fafc;
            color: var(--ps-slate);
        }

        /* Chart Container Styling - Mandatory Strict Constraints */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }

        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar { height: 6px; width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #f1f5f9; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }

        /* CSS Logo Recreation (No SVG) */
        .logo-wrapper {
            position: relative;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .logo-base {
            position: absolute;
            width: 100%;
            height: 100%;
            background-color: #d1d5db; /* Light grey base */
            border-radius: 50%;
        }
        .logo-blade {
            position: absolute;
            width: 20%;
            height: 40%;
            background-color: #6b7280; /* Darker grey blade */
            border-radius: 50% 50% 10% 10%;
            top: 10%;
            left: 40%;
            transform-origin: 50% 100%;
        }
        .logo-dot {
            position: absolute;
            width: 6px;
            height: 6px;
            background-color: #ef4444; /* Red dot */
            border-radius: 50%;
            z-index: 10;
            box-shadow: 0 1px 2px rgba(0,0,0,0.2);
        }
        .logo-center {
            position: absolute;
            width: 8px;
            height: 8px;
            background-color: #000;
            border-radius: 50%;
            z-index: 20;
        }

        /* Toast Notification */
        .toast-container {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 50;
            display: flex;
            flex-direction: column;
            gap: 12px;
            pointer-events: none;
        }
        .toast-item {
            background: #1e293b;
            color: white;
            padding: 16px 20px;
            border-radius: 12px;
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 12px;
            transform: translateX(120%);
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: auto;
            border-left: 4px solid var(--ps-teal);
            min-width: 300px;
        }
        .toast-item.show { transform: translateX(0); }

        /* Status Tags */
        .tag {
            padding: 4px 10px;
            font-size: 11px;
            font-weight: 700;
            border-radius: 6px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        .status-completed { background: #dcfce7; color: #166534; }
        .status-progress { background: #e0f2fe; color: #0369a1; }
        .status-pending { background: #f1f5f9; color: #475569; }
        .status-overdue { background: #fee2e2; color: #991b1b; }

        /* Animations */
        .hover-lift { transition: transform 0.2s; }
        .hover-lift:hover { transform: translateY(-2px); }
    </style>
    <!-- Chosen Palette: Perpetual Teal (Brand Color) + Industrial Grey -->
    <!-- Application Structure Plan: 
         1. Header: Recreated CSS Logo & Navigation.
         2. Hero: Company Mission & "Baby Steps in IT" Context.
         3. Operations Dashboard: KPI Cards & Charts (Workload vs Status).
         4. Action Tracker: The core interactive element. Maps specific employees (Anurag, Avinash, etc.) to their specialized roles (IT, HAZOP, Energy). Includes Slack/Discord triggers.
         5. Services Grid: Overview of the 5 business pillars.
         6. Footer: Global presence info.
    -->
    <!-- Visualization & Content Choices:
         - Charts: Chart.js for "Task Distribution" (Donut) and "Specialist Workload" (Bar).
         - Data: Hardcoded mock data reflecting the specific roles (Anurag=IT, Saksham=Chem, etc.).
         - Interaction: Filtering the table updates the charts dynamically. Nudge buttons trigger simulated API calls via Toasts.
    -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</head>
<body class="bg-slate-50">

    <div id="toast-container" class="toast-container"></div>

    <!-- Navigation -->
    <nav class="bg-white/90 backdrop-blur-md border-b border-slate-200 sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20 items-center">
                <!-- Logo Section -->
                <div class="flex items-center gap-3">
                    <div class="flex items-center gap-3">
    <img 
        src="assets/PS Logo.gif"
        alt="Perpetual Solutions Logo"
        class="h-14 w-auto object-contain"
    />
    <div>
        <!-- <h1 class="text-3xl font-black text-[color:var(--ps-teal)] tracking-tighter leading-none">
            Perpetual
        </h1>
        <p class="text-sm font-bold text-slate-800 tracking-wide uppercase">
            Solutions
        </p> -->
    </div>
</div>
                    <div>
                        <!-- <h1 class="text-3xl font-black text-[color:var(--ps-teal)] tracking-tighter leading-none">Perpetual</h1>
                        <p class="text-sm font-bold text-slate-800 tracking-wide uppercase">Solutions</p> -->
                    </div>
                </div>
                
                <!-- Desktop Nav -->
                <div class="hidden md:flex gap-8 items-center">
                    <a href="#dashboard" class="text-xs font-bold text-slate-500 uppercase tracking-widest hover:text-[color:var(--ps-teal)] transition">Dashboard</a>
                    <a href="#tracker" class="text-xs font-bold text-slate-500 uppercase tracking-widest hover:text-[color:var(--ps-teal)] transition">Action Tracker</a>
                    <a href="#services" class="text-xs font-bold text-slate-500 uppercase tracking-widest hover:text-[color:var(--ps-teal)] transition">Services</a>
                </div>

                <!-- Status Indicator -->
                <div class="hidden lg:flex items-center gap-2 bg-teal-50 px-3 py-1 rounded-full border border-teal-100">
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                    <span class="text-[10px] font-bold text-teal-700 uppercase">Login</span>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-10 space-y-12">

        <!-- Intro Section -->
        <section class="bg-white rounded-[2rem] border border-slate-200 shadow-sm p-8 md:p-12 relative overflow-hidden">
            <div class="relative z-10 max-w-4xl">
                <div class="flex items-center gap-2 mb-4">
                    <span class="px-3 py-1 rounded-full bg-slate-100 text-slate-600 text-[10px] font-bold uppercase tracking-wider">Nagpur ‚Ä¢ Hyderabad ‚Ä¢ USA ‚Ä¢ Oman</span>
                </div>
                <h1 class="text-4xl md:text-5xl font-black text-slate-900 mb-6">
                    Bridging Industrial Safety with <span class="text-[color:var(--ps-teal)]">Digital Innovation</span>
                </h1>
                <p class="text-slate-600 text-lg leading-relaxed mb-8">
                    Perpetual Solutions helps organizations minimize risk and maximize sustainability. 
                    As we take our <strong>"next steps" into the IT industry</strong>, this platform serves as the central bridge‚Äîconnecting our veteran Chemical Engineers (HAZOP, Process Safety) with our emerging Digital Team (LMS, Social Media).
                </p>
                <div class="flex gap-4">
                    <button onclick="document.getElementById('tracker').scrollIntoView({behavior: 'smooth'})" class="bg-[color:var(--ps-teal)] text-white px-6 py-3 rounded-xl font-bold hover:bg-[color:var(--ps-teal-dark)] transition shadow-lg shadow-teal-200">
                        View Active Tasks
                    </button>
                    <button onclick="document.getElementById('services').scrollIntoView({behavior: 'smooth'})" class="bg-white text-slate-700 border border-slate-300 px-6 py-3 rounded-xl font-bold hover:bg-slate-50 transition">
                        Our Services
                    </button>
                </div>
            </div>
            <!-- Decorative Circle -->
            <div class="absolute -right-20 -top-20 w-96 h-96 bg-[color:var(--ps-teal)] rounded-full opacity-5 pointer-events-none"></div>
        </section>

        <!-- KPI Dashboard -->
        <section id="dashboard" class="scroll-mt-24">
            <div class="mb-6">
                <h2 class="text-2xl font-bold text-slate-900">Operational Overview</h2>
                <p class="text-sm text-slate-500">Real-time metrics across Engineering, Management, and IT sectors.</p>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
                <div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm hover-lift">
                    <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Total Actions</p>
                    <h3 id="kpi-total" class="text-3xl font-black text-slate-900 mt-2">0</h3>
                </div>
                <div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm hover-lift">
                    <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Completion Rate</p>
                    <h3 id="kpi-rate" class="text-3xl font-black text-[color:var(--ps-teal)] mt-2">0%</h3>
                </div>
                <div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm hover-lift">
                    <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Critical Overdue</p>
                    <h3 id="kpi-overdue" class="text-3xl font-black text-[color:var(--ps-red)] mt-2">0</h3>
                </div>
                <div class="bg-white p-6 rounded-2xl border border-slate-200 shadow-sm hover-lift border-l-4 border-l-[color:var(--ps-teal)]">
                    <p class="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Nudges Sent</p>
                    <h3 id="kpi-nudges" class="text-3xl font-black text-slate-900 mt-2">0</h3>
                    <p class="text-[10px] text-slate-400 mt-1">Via Slack & Discord</p>
                </div>
            </div>

            <!-- Charts -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-3xl border border-slate-200 shadow-sm">
                    <h4 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-6">Task Status Distribution</h4>
                    <div class="chart-container">
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-3xl border border-slate-200 shadow-sm">
                    <h4 class="text-xs font-bold text-slate-400 uppercase tracking-widest mb-6">Specialist Workload</h4>
                    <div class="chart-container">
                        <canvas id="workloadChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <!-- Master Action Tracker -->
        <section id="tracker" class="scroll-mt-24">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-end gap-4 mb-6">
                <div>
                    <h2 class="text-2xl font-bold text-slate-900">Master Action Database</h2>
                    <p class="text-sm text-slate-500 max-w-xl">
                        Centralized task management. Use the filters to view specific departmental loads or individual assignments. 
                        Click the messaging icons to trigger immediate updates to the team.
                    </p>
                </div>
                
                <div class="flex gap-2 w-full md:w-auto">
                    <select id="personFilter" class="bg-white border border-slate-200 text-xs font-bold rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[color:var(--ps-teal)] shadow-sm">
                        <option value="All">All Personnel</option>
                    </select>
                    <select id="deptFilter" class="bg-white border border-slate-200 text-xs font-bold rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[color:var(--ps-teal)] shadow-sm">
                        <option value="All">All Departments</option>
                        <option value="Management">Management</option>
                        <option value="IT & Digitalization">IT & Digitalization</option>
                        <option value="Chemical Engineering">Chemical Engineering</option>
                        <option value="Admin & HR">Admin & HR</option>
                    </select>
                </div>
            </div>

            <div class="bg-white rounded-[1.5rem] border border-slate-200 shadow-lg overflow-hidden">
                <div class="overflow-x-auto custom-scrollbar">
                    <table class="w-full text-left border-collapse">
                        <thead class="bg-slate-50 border-b border-slate-100">
                            <tr>
                                <th class="px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest">Task Details</th>
                                <th class="px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest">Owner / Role</th>
                                <th class="px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest">Department</th>
                                <th class="px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest">Status</th>
                                <th class="px-6 py-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest text-center">Deadline</th>
                                <th class="px-6 py-4 text-[10px] font-bold text-white uppercase tracking-widest text-center bg-[color:var(--ps-teal)]">Quick Action</th>
                            </tr>
                        </thead>
                        <tbody id="actionTableBody" class="divide-y divide-slate-50">
                            <!-- Rows injected by JS -->
                        </tbody>
                    </table>
                </div>
                <div class="px-6 py-4 bg-slate-50 border-t border-slate-100 text-center">
                    <p class="text-[10px] text-slate-400 italic">Showing active tasks for Perpetual Solutions HQ</p>
                </div>
            </div>
        </section>

        <!-- Services / Business Info -->
        <section id="services" class="scroll-mt-24 pt-8 border-t border-slate-200">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-slate-900">Our Expertise</h2>
                <p class="text-slate-500 mt-2">Comprehensive solutions for industrial safety and digital transformation.</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4">
                <!-- Card 1 -->
                <div class="bg-white p-6 rounded-2xl border border-slate-200 hover:border-[color:var(--ps-teal)] transition group">
                    <div class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center mb-4 group-hover:bg-teal-50 transition">
                        <span class="text-xl">‚ö†Ô∏è</span>
                    </div>
                    <h3 class="font-bold text-sm text-slate-900 mb-2">Process Safety</h3>
                    <p class="text-[11px] text-slate-500 leading-relaxed">HAZOP studies, LOPA, and Process Hazard Analysis to reduce operational risks.</p>
                </div>
                <!-- Card 2 -->
                <div class="bg-white p-6 rounded-2xl border border-slate-200 hover:border-[color:var(--ps-teal)] transition group">
                    <div class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center mb-4 group-hover:bg-teal-50 transition">
                        <span class="text-xl">üå±</span>
                    </div>
                    <h3 class="font-bold text-sm text-slate-900 mb-2">Sustainability</h3>
                    <p class="text-[11px] text-slate-500 leading-relaxed">Energy Audits, ESG reporting, and Green Building compliance.</p>
                </div>
                <!-- Card 3 -->
                <div class="bg-white p-6 rounded-2xl border border-slate-200 hover:border-[color:var(--ps-teal)] transition group">
                    <div class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center mb-4 group-hover:bg-teal-50 transition">
                        <span class="text-xl">‚öôÔ∏è</span>
                    </div>
                    <h3 class="font-bold text-sm text-slate-900 mb-2">Process Improv.</h3>
                    <p class="text-[11px] text-slate-500 leading-relaxed">Simulation modeling, troubleshooting, and commissioning support.</p>
                </div>
                <!-- Card 4 -->
                <div class="bg-white p-6 rounded-2xl border border-slate-200 hover:border-[color:var(--ps-teal)] transition group">
                    <div class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center mb-4 group-hover:bg-teal-50 transition">
                        <span class="text-xl">üéì</span>
                    </div>
                    <h3 class="font-bold text-sm text-slate-900 mb-2">Training</h3>
                    <p class="text-[11px] text-slate-500 leading-relaxed">Competency programs for Safety, Fire, and Behavioral Safety (BBS).</p>
                </div>
                <!-- Card 5 (IT Highlight) -->
                <div class="bg-teal-50 p-6 rounded-2xl border border-teal-200 hover:shadow-md transition">
                    <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center mb-4">
                        <span class="text-xl">üíª</span>
                    </div>
                    <h3 class="font-bold text-sm text-[color:var(--ps-teal-dark)] mb-2">Digital Tools</h3>
                    <p class="text-[11px] text-slate-600 leading-relaxed">Software for BRSR, HAZOP automation, and custom Action Trackers (like this one).</p>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-slate-900 text-white mt-20 py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                <div class="col-span-1 md:col-span-2">
                    <h4 class="text-2xl font-black mb-4 tracking-tighter">Perpetual Solutions</h4>
                    <p class="text-slate-400 text-sm max-w-sm">
                        Helping organizations become safer, more efficient, and sustainable.
                        <br>ISO 9001:2015 Certified.
                    </p>
                </div>
                <div>
                    <h5 class="font-bold text-sm mb-3 text-[color:var(--ps-teal)]">Headquarters</h5>
                    <p class="text-xs text-slate-400">Nagpur, Maharashtra, India</p>
                    <p class="text-xs text-slate-400 mt-1">Hyderabad, India</p>
                </div>
                <div>
                    <h5 class="font-bold text-sm mb-3 text-[color:var(--ps-teal)]">Global</h5>
                    <p class="text-xs text-slate-400">Wisconsin, USA</p>
                    <p class="text-xs text-slate-400 mt-1">Muscat, Oman</p>
                </div>
            </div>
            <div class="border-t border-slate-800 pt-8 flex flex-col md:flex-row justify-between items-center gap-4">
                <p class="text-[10px] text-slate-500 uppercase tracking-widest">&copy; 2026 Perpetual Solutions. All Rights Reserved.</p>
                <div class="flex gap-4">
                    <span class="w-2 h-2 rounded-full bg-[color:var(--ps-teal)]"></span>
                    <span class="text-[10px] font-bold text-slate-500 uppercase">Prototype v2.1 (Anurag Yamnurwar)</span>
                </div>
            </div>
        </div>
    </footer>

    <!-- Application Logic -->
    <script>
        // --- DATA ---
        
        // Employee Mapping based on prompt
        const employees = {
            "Anurag": { role: "IT Engineer", dept: "IT & Digitalization", avatar: "AY", bg: "bg-purple-100 text-purple-700", slack: "@anurag_it", discord: "anurag#7777" },
            "Avinash": { role: "Managing Director", dept: "Management", avatar: "AG", bg: "bg-slate-200 text-slate-700", slack: "@avinash_md", discord: "avinash#1111" },
            "Swapnil": { role: "Executive Director", dept: "Management", avatar: "SK", bg: "bg-blue-100 text-blue-700", slack: "@swapnil_ed", discord: "swapnil#2222" },
            "Saksham": { role: "Chemical Engineer", dept: "Chemical Engineering", avatar: "SM", bg: "bg-orange-100 text-orange-700", slack: "@saksham_ce", discord: "saksham#3333" },
            "Kalyani": { role: "Chemical Engineer", dept: "Chemical Engineering", avatar: "KN", bg: "bg-rose-100 text-rose-700", slack: "@kalyani_ce", discord: "kalyani#4444" },
            "Rohan": { role: "Admin & HR", dept: "Admin & HR", avatar: "RH", bg: "bg-green-100 text-green-700", slack: "@rohan_hr", discord: "rohan#5555" }
        };

        // Tasks mapped to roles
        const initialTasks = [
            { id: "TK-101", desc: "HAZOP Study: Reactor Unit 4 Safety Review", person: "Avinash", dept: "Management", status: "In Progress", target: "2025-06-15" },
            { id: "TK-102", desc: "LMS: Upload 'Fire Safety' Module", person: "Anurag", dept: "IT & Digitalization", status: "Not Started", target: "2025-06-01" },
            { id: "TK-103", desc: "Energy Audit: Monthly Power Consumption Report", person: "Swapnil", dept: "Management", status: "Completed", target: "2025-05-28" },
            { id: "TK-104", desc: "Social Media: 'Sustainability Week' Post", person: "Anurag", dept: "IT & Digitalization", status: "In Progress", target: "2025-06-05" },
            { id: "TK-105", desc: "Scribe Work: LOPA Documentation Draft", person: "Saksham", dept: "Chemical Engineering", status: "Overdue", target: "2025-05-20" },
            { id: "TK-106", desc: "Accounts: Q1 Billing Consolidation", person: "Swapnil", dept: "Management", status: "In Progress", target: "2025-06-20" },
            { id: "TK-107", desc: "Process Improvement: Catalyst Efficiency Model", person: "Kalyani", dept: "Chemical Engineering", status: "In Progress", target: "2025-06-10" },
            { id: "TK-108", desc: "HR: Recruitment Drive (Nagpur Office)", person: "Rohan", dept: "Admin & HR", status: "In Progress", target: "2025-06-30" },
            { id: "TK-109", desc: "IT Support: Configure New Server for App", person: "Anurag", dept: "IT & Digitalization", status: "Completed", target: "2025-05-15" },
            { id: "TK-110", desc: "Chemical Training: Deliver 'Safe Handling' Seminar", person: "Avinash", dept: "Management", status: "Not Started", target: "2025-06-25" }
        ];

        // --- STATE ---
        let currentTasks = [...initialTasks];
        let nudgeCount = 0;
        let chartInstances = {};
        const SIMULATED_TODAY = new Date("2025-06-01");

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', () => {
            initFilters();
            initCharts();
            renderDashboard();
        });

        // --- CORE FUNCTIONS ---

        function initFilters() {
            const pFilter = document.getElementById('personFilter');
            Object.keys(employees).forEach(name => {
                let opt = document.createElement('option');
                opt.value = name;
                opt.innerText = name;
                pFilter.appendChild(opt);
            });

            pFilter.addEventListener('change', handleFilter);
            document.getElementById('deptFilter').addEventListener('change', handleFilter);
        }

        function handleFilter() {
            const pVal = document.getElementById('personFilter').value;
            const dVal = document.getElementById('deptFilter').value;

            currentTasks = initialTasks.filter(t => {
                return (pVal === "All" || t.person === pVal) && (dVal === "All" || t.dept === dVal);
            });
            renderDashboard();
        }

        function triggerNudge(platform, personName, taskDesc) {
            const emp = employees[personName];
            const handle = platform === 'Slack' ? emp.slack : emp.discord;
            const icon = platform === 'Slack' ? 'üí¨' : 'üëæ';
            
            // Create Toast
            const toast = document.createElement('div');
            toast.className = 'toast-item';
            toast.innerHTML = `
                <div class="text-2xl">${icon}</div>
                <div>
                    <p class="text-[10px] font-black uppercase text-slate-400">Sent via ${platform}</p>
                    <p class="text-sm font-bold">Nudged ${personName}</p>
                    <p class="text-xs text-slate-400 mt-1 truncate w-40">${taskDesc}</p>
                </div>
            `;
            
            document.getElementById('toast-container').appendChild(toast);
            
            // Animate In
            setTimeout(() => toast.classList.add('show'), 10);
            
            // Update Stats
            nudgeCount++;
            document.getElementById('kpi-nudges').innerText = nudgeCount;

            // Animate Out
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 400);
            }, 3000);
        }

        function renderDashboard() {
            // Render Table
            const tbody = document.getElementById('actionTableBody');
            tbody.innerHTML = '';
            
            let completed = 0, overdue = 0;

            currentTasks.forEach(task => {
                const emp = employees[task.person];
                
                // Logic for overdue
                let isLate = false;
                if(task.status !== 'Completed') {
                    if(new Date(task.target) < SIMULATED_TODAY || task.status === 'Overdue') {
                        isLate = true;
                        overdue++;
                    }
                }
                if(task.status === 'Completed') completed++;

                const tr = document.createElement('tr');
                tr.className = "hover:bg-slate-50 transition border-b border-slate-50 last:border-0";
                tr.innerHTML = `
                    <td class="px-6 py-4">
                        <p class="text-xs font-bold text-slate-800">${task.desc}</p>
                        <p class="text-[10px] text-slate-400 font-mono mt-0.5">${task.id}</p>
                    </td>
                    <td class="px-6 py-4">
                        <div class="flex items-center gap-2">
                            <div class="w-6 h-6 rounded-md ${emp.bg} flex items-center justify-center text-[10px] font-bold shadow-sm">
                                ${emp.avatar}
                            </div>
                            <div>
                                <p class="text-xs font-bold text-slate-700">${task.person}</p>
                                <p class="text-[9px] text-slate-400">${emp.role}</p>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4">
                        <span class="text-[10px] font-bold text-slate-500 uppercase tracking-tight">${task.dept}</span>
                    </td>
                    <td class="px-6 py-4">
                        <span class="tag ${getStatusClass(task.status)}">${task.status}</span>
                    </td>
                    <td class="px-6 py-4 text-center">
                        <span class="text-xs font-mono ${isLate ? 'text-red-600 font-bold' : 'text-slate-500'}">${task.target}</span>
                    </td>
                    <td class="px-6 py-4 bg-teal-50/30">
                        <div class="flex justify-center gap-2">
                            <button onclick="triggerNudge('Slack', '${task.person}', '${task.desc}')" 
                                class="p-2 bg-white border border-slate-200 rounded-lg hover:border-[color:var(--ps-teal)] hover:text-[color:var(--ps-teal)] transition shadow-sm group" title="Slack">
                                <span class="text-sm group-hover:scale-110 block transition">üí¨</span>
                            </button>
                            <button onclick="triggerNudge('Discord', '${task.person}', '${task.desc}')" 
                                class="p-2 bg-white border border-slate-200 rounded-lg hover:border-indigo-500 hover:text-indigo-500 transition shadow-sm group" title="Discord">
                                <span class="text-sm group-hover:scale-110 block transition">üëæ</span>
                            </button>
                        </div>
                    </td>
                `;
                tbody.appendChild(tr);
            });

            // Update KPIs
            document.getElementById('kpi-total').innerText = currentTasks.length;
            document.getElementById('kpi-overdue').innerText = overdue;
            const rate = currentTasks.length > 0 ? Math.round((completed / currentTasks.length) * 100) : 0;
            document.getElementById('kpi-rate').innerText = rate + '%';

            updateCharts();
        }

        function getStatusClass(status) {
            switch(status) {
                case 'Completed': return 'status-completed';
                case 'In Progress': return 'status-progress';
                case 'Overdue': return 'status-overdue';
                default: return 'status-pending';
            }
        }

        // --- CHARTS ---
        function initCharts() {
            Chart.defaults.font.family = "'Plus Jakarta Sans', sans-serif";
            Chart.defaults.color = '#64748b';
            
            // Status Chart
            const ctx1 = document.getElementById('statusChart').getContext('2d');
            chartInstances.status = new Chart(ctx1, {
                type: 'doughnut',
                data: {
                    labels: ['Completed', 'In Progress', 'Overdue', 'Not Started'],
                    datasets: [{
                        data: [0,0,0,0],
                        backgroundColor: ['#10b981', '#0ea5e9', '#ef4444', '#cbd5e1'],
                        borderWidth: 0,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '75%',
                    plugins: { legend: { position: 'bottom', labels: { usePointStyle: true, boxWidth: 6 } } }
                }
            });

            // Workload Chart
            const ctx2 = document.getElementById('workloadChart').getContext('2d');
            chartInstances.workload = new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: [],
                    datasets: [{
                        label: 'Assigned Tasks',
                        data: [],
                        backgroundColor: '#00b8b8',
                        borderRadius: 4,
                        barThickness: 20
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { beginAtZero: true, grid: { display: false } },
                        y: { grid: { display: false } }
                    }
                }
            });
        }

        function updateCharts() {
            // Process Data
            const statusCounts = { 'Completed': 0, 'In Progress': 0, 'Overdue': 0, 'Not Started': 0 };
            const personCounts = {};

            currentTasks.forEach(t => {
                let s = t.status;
                if(s === 'Overdue') statusCounts['Overdue']++;
                else statusCounts[s]++;

                personCounts[t.person] = (personCounts[t.person] || 0) + 1;
            });

            // Update Status Chart
            chartInstances.status.data.datasets[0].data = Object.values(statusCounts);
            chartInstances.status.update();

            // Update Workload Chart
            chartInstances.workload.data.labels = Object.keys(personCounts);
            chartInstances.workload.data.datasets[0].data = Object.values(personCounts);
            chartInstances.workload.update();
        }

    </script>
</body>
</html>